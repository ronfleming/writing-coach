@page "/about-us"
@inject AuthService Auth
@inject PhraseApiService PhraseApi

<PageTitle>About - German Writing Coach | AI-Powered German Writing Assistant</PageTitle>

<HeadContent>
    <meta name="description" content="German Writing Coach is a free AI-powered tool that helps German language learners improve their writing with grammar corrections, style upgrades, and targeted feedback for Goethe-Institut exam levels A1 through C2." />
    <meta property="og:title" content="About - German Writing Coach" />
    <meta property="og:description" content="Free AI-powered German writing assistant. Get grammar corrections, style upgrades, and exam preparation feedback for all CEFR levels." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://germanwritingcoach.com/og-image.png" />
    <link rel="canonical" href="https://germanwritingcoach.com/about-us" />
</HeadContent>

<div class="about-container">
    <header class="about-header">
        <h1>About Us</h1>
    </header>

    <section class="about-section">
        <h2>What is German Writing Coach?</h2>
        <p>
            German Writing Coach is a free, AI-powered tool that helps German language learners transform 
            rough drafts into polished, natural German prose. It supports all CEFR proficiency levels ‚Äî 
            from A1 beginners to C2 advanced ‚Äî and is especially useful for learners preparing for 
            Goethe-Institut or TestDaF exams who need practical feedback on real-world writing tasks.
        </p>
        <p>
            Unlike simple German grammar checkers, German Writing Coach provides:
        </p>
        <ul>
            <li><strong>Two-pass corrections</strong> ‚Äî See both minimal grammar fixes and a fully upgraded version of your German text</li>
            <li><strong>Targeted feedback</strong> ‚Äî Learn from your specific mistakes with memorable rules</li>
            <li><strong>Phrase bank</strong> ‚Äî Build your German vocabulary with reusable expressions extracted from your sessions</li>
            <li><strong>Context awareness</strong> ‚Äî Get register-appropriate suggestions for professional, bureaucratic, or casual German writing</li>
        </ul>
    </section>

    <section class="about-section">
        <h2>Who is this for?</h2>
        <ul>
            <li><strong>Exam candidates</strong> ‚Äî Preparing for Goethe-Institut exams (A1, A2, B1, B2, C1, C2) or TestDaF? Practice your written German and get instant feedback at your target level.</li>
            <li><strong>Professionals</strong> ‚Äî Writing cover letters, business emails, or reports in German? Get polished, register-appropriate text.</li>
            <li><strong>Expats in Germany</strong> ‚Äî Communicating with Beh√∂rden, landlords, or insurance companies? Get help crafting clear, formal German.</li>
            <li><strong>Self-learners</strong> ‚Äî Anyone looking to improve their German writing skills with AI-powered guidance and a personal phrase bank.</li>
        </ul>
    </section>

    <section class="about-section">
        <h2>Technology</h2>
        <p>Built with:</p>
        <ul>
            <li><strong>Frontend:</strong> Blazor WebAssembly</li>
            <li><strong>Backend:</strong> Azure Functions (C#)</li>
            <li><strong>Database:</strong> Azure Cosmos DB</li>
            <li><strong>AI:</strong> OpenAI GPT-4.1-mini with structured JSON outputs</li>
            <li><strong>Hosting:</strong> Azure Static Web Apps</li>
        </ul>
        <p>
            The project is open source on <a href="https://github.com/ronfleming/writing-coach" target="_blank">GitHub</a>.
        </p>
    </section>

    <section class="about-section">
        <h2>Privacy & Data</h2>
        <p>
            Your text is sent to OpenAI's API for analysis. When you're signed in, your coaching sessions 
            and phrase bank are stored in Azure Cosmos DB. Anonymous usage is not persisted.
        </p>
        <p>
            We collect only data essential to the service ‚Äî your coaching sessions and extracted phrases. 
            We do not use tracking cookies or third-party analytics beyond Application Insights for 
            operational monitoring.
        </p>
        <p>
            <a href="/privacy">Privacy Policy</a> ¬∑ <a href="/terms">Terms of Service</a>
        </p>
    </section>

    <section class="about-section">
        <h2>Your Data</h2>
        <p>
            You have the right to delete all data associated with your account at any time. 
            This includes your coaching session history and all phrases in your phrase bank. 
            This action is permanent and cannot be undone.
        </p>

        @if (Auth.IsAuthenticated)
        {
            <div class="delete-data-section">
                @if (!showDeleteConfirm)
                {
                    <button class="delete-data-btn" @onclick="ShowDeleteConfirm" disabled="@isDeleting">
                        üóëÔ∏è Delete All My Data
                    </button>
                }
                else
                {
                    <div class="delete-confirm">
                        <p class="confirm-warning">
                            <strong>‚ö†Ô∏è Are you sure?</strong> This will permanently delete all your sessions and phrases. 
                            This cannot be undone.
                        </p>
                        <div class="confirm-actions">
                            <button class="confirm-delete-btn" @onclick="DeleteMyData" disabled="@isDeleting">
                                @if (isDeleting)
                                {
                                    <span>Deleting...</span>
                                }
                                else
                                {
                                    <span>Yes, delete everything</span>
                                }
                            </button>
                            <button class="confirm-cancel-btn" @onclick="CancelDelete" disabled="@isDeleting">
                                Cancel
                            </button>
                        </div>
                    </div>
                }
                @if (deleteMessage is not null)
                {
                    <div class="delete-feedback @(deleteSuccess ? "" : "error")">@deleteMessage</div>
                }
            </div>
        }
        else
        {
            <div class="delete-data-section">
                <button class="delete-data-btn disabled" disabled title="Sign in to manage your data">
                    üóëÔ∏è Delete All My Data
                </button>
                <p class="delete-hint">Sign in to manage your data.</p>
            </div>
        }
    </section>

    <div class="about-footer">
        <a href="/" class="back-link">‚Üê Back to Writing Coach</a>
    </div>
</div>

@code {
    private bool showDeleteConfirm;
    private bool isDeleting;
    private string? deleteMessage;
    private bool deleteSuccess;

    protected override async Task OnInitializedAsync()
    {
        await Auth.GetAuthStateAsync();
    }

    private void ShowDeleteConfirm()
    {
        showDeleteConfirm = true;
        deleteMessage = null;
    }

    private void CancelDelete()
    {
        showDeleteConfirm = false;
    }

    private async Task DeleteMyData()
    {
        isDeleting = true;
        deleteMessage = null;

        try
        {
            var success = await PhraseApi.DeleteMyDataAsync();
            if (success)
            {
                deleteSuccess = true;
                deleteMessage = "‚úÖ All your data has been deleted.";
                showDeleteConfirm = false;
            }
            else
            {
                deleteSuccess = false;
                deleteMessage = "‚ùå Failed to delete data. Please try again.";
            }
        }
        catch (Exception ex)
        {
            deleteSuccess = false;
            deleteMessage = $"‚ùå {ex.Message}";
        }
        finally
        {
            isDeleting = false;
        }
    }
}
