@page "/about-us"
@inject AuthService Auth
@inject PhraseApiService PhraseApi

<PageTitle>About - German Writing Coach</PageTitle>

<HeadContent>
    <meta name="description" content="German Writing Coach is an AI-powered tool that helps language learners transform rough drafts into polished, natural German prose with targeted feedback and reusable phrases." />
    <meta property="og:title" content="About - German Writing Coach" />
    <meta property="og:description" content="Learn about German Writing Coach, an AI-powered German writing assistant built by Ron Fleming." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://germanwritingcoach.com/og-image.png" />
    <link rel="canonical" href="https://germanwritingcoach.com/about-us" />
</HeadContent>

<div class="about-container">
    <header class="about-header">
        <h1>About Us</h1>
    </header>

    <section class="about-section">
        <h2>What is this?</h2>
        <p>
            Writing Coach is an AI-powered tool that helps language learners transform rough drafts into 
            polished, natural prose. It's designed for learners preparing for advanced proficiency levels 
            (B2/C1) who need practical feedback on real-world writing tasks.
        </p>
        <p>
            Unlike simple grammar checkers, Writing Coach provides:
        </p>
        <ul>
            <li><strong>Two-pass corrections</strong> ‚Äî See both minimal fixes and fully upgraded text</li>
            <li><strong>Targeted feedback</strong> ‚Äî Learn from your specific mistakes with memorable rules</li>
            <li><strong>Phrase bank extraction</strong> ‚Äî Build your vocabulary with reusable expressions</li>
            <li><strong>Context awareness</strong> ‚Äî Get register-appropriate suggestions for professional, bureaucratic, or casual contexts</li>
        </ul>
    </section>

    <section class="about-section">
        <h2>Who built this?</h2>
        <p>
            This tool was created by <a href="https://ronfleming.com" target="_blank">Ron Fleming</a>, 
            a software developer and US Army veteran currently preparing for C1-level German proficiency 
            as part of a move to Germany.
        </p>
        <p>
            Writing Coach started as a personal tool to accelerate language learning through practical 
            writing practice. It demonstrates real-world AI integration in a .NET application while 
            solving a genuine problem: turning language study into actionable, reusable learning artifacts.
        </p>
    </section>

    <section class="about-section">
        <h2>Technology</h2>
        <p>Built with:</p>
        <ul>
            <li><strong>Frontend:</strong> Blazor WebAssembly</li>
            <li><strong>Backend:</strong> Azure Functions (C#)</li>
            <li><strong>Database:</strong> Azure Cosmos DB</li>
            <li><strong>AI:</strong> OpenAI GPT-4.1-mini with structured JSON outputs</li>
            <li><strong>Hosting:</strong> Azure Static Web Apps</li>
        </ul>
        <p>
            The project is open source on <a href="https://github.com/ronfleming/writing-coach" target="_blank">GitHub</a>.
        </p>
    </section>

    <section class="about-section">
        <h2>Privacy & Data</h2>
        <p>
            Your text is sent to OpenAI's API for analysis. When you're signed in, your coaching sessions 
            and phrase bank are stored in Azure Cosmos DB. Anonymous usage is not persisted.
        </p>
        <p>
            We collect only data essential to the service ‚Äî your coaching sessions and extracted phrases. 
            We do not use tracking cookies or third-party analytics beyond Application Insights for 
            operational monitoring.
        </p>
        <p>
            <a href="/privacy">Privacy Policy</a> ¬∑ <a href="/terms">Terms of Service</a>
        </p>
    </section>

    <section class="about-section">
        <h2>Your Data</h2>
        <p>
            You have the right to delete all data associated with your account at any time. 
            This includes your coaching session history and all phrases in your phrase bank. 
            This action is permanent and cannot be undone.
        </p>

        @if (Auth.IsAuthenticated)
        {
            <div class="delete-data-section">
                @if (!showDeleteConfirm)
                {
                    <button class="delete-data-btn" @onclick="ShowDeleteConfirm" disabled="@isDeleting">
                        üóëÔ∏è Delete All My Data
                    </button>
                }
                else
                {
                    <div class="delete-confirm">
                        <p class="confirm-warning">
                            <strong>‚ö†Ô∏è Are you sure?</strong> This will permanently delete all your sessions and phrases. 
                            This cannot be undone.
                        </p>
                        <div class="confirm-actions">
                            <button class="confirm-delete-btn" @onclick="DeleteMyData" disabled="@isDeleting">
                                @if (isDeleting)
                                {
                                    <span>Deleting...</span>
                                }
                                else
                                {
                                    <span>Yes, delete everything</span>
                                }
                            </button>
                            <button class="confirm-cancel-btn" @onclick="CancelDelete" disabled="@isDeleting">
                                Cancel
                            </button>
                        </div>
                    </div>
                }
                @if (deleteMessage is not null)
                {
                    <div class="delete-feedback @(deleteSuccess ? "" : "error")">@deleteMessage</div>
                }
            </div>
        }
        else
        {
            <div class="delete-data-section">
                <button class="delete-data-btn disabled" disabled title="Sign in to manage your data">
                    üóëÔ∏è Delete All My Data
                </button>
                <p class="delete-hint">Sign in to manage your data.</p>
            </div>
        }
    </section>

    <div class="about-footer">
        <a href="/" class="back-link">‚Üê Back to Writing Coach</a>
    </div>
</div>

@code {
    private bool showDeleteConfirm;
    private bool isDeleting;
    private string? deleteMessage;
    private bool deleteSuccess;

    protected override async Task OnInitializedAsync()
    {
        await Auth.GetAuthStateAsync();
    }

    private void ShowDeleteConfirm()
    {
        showDeleteConfirm = true;
        deleteMessage = null;
    }

    private void CancelDelete()
    {
        showDeleteConfirm = false;
    }

    private async Task DeleteMyData()
    {
        isDeleting = true;
        deleteMessage = null;

        try
        {
            var success = await PhraseApi.DeleteMyDataAsync();
            if (success)
            {
                deleteSuccess = true;
                deleteMessage = "‚úÖ All your data has been deleted.";
                showDeleteConfirm = false;
            }
            else
            {
                deleteSuccess = false;
                deleteMessage = "‚ùå Failed to delete data. Please try again.";
            }
        }
        catch (Exception ex)
        {
            deleteSuccess = false;
            deleteMessage = $"‚ùå {ex.Message}";
        }
        finally
        {
            isDeleting = false;
        }
    }
}
